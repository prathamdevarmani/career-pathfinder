{% extends "base.html" %}

{% block title %}Profile - Career Pathfinder{% endblock %}

{% block content %}
<div class="container py-4 pb-5">
    <form id="profileForm" method="POST">
        <!-- Profile Header -->
        <div class="text-center mb-5">
            <h1 class="fw-bold text-white mb-2">Your Skills Profile</h1>
            <p class="text-muted mb-0">Manage your skills and expertise</p>
        </div>

        <!-- Right Column - Skills -->
        <div class="col-lg-12">
            <!-- IT Skills Section -->
            <div class="card shadow-sm mb-4 border-0" style="background-color: #f8fafc;">
                <div class="card-header bg-transparent border-0 pt-4 px-4">
                    <h5 class="fw-semibold text-dark mb-0">
                        <i class="fas fa-laptop-code me-2 text-primary"></i>Technical Skills
                    </h5>
                </div>
                <div class="card-body p-0">
                    <div class="accordion" id="itSkillsAccordion" style="--bs-accordion-border-color: transparent;">
                        {% for category, skills in it_skills.items() %}
                        <div class="accordion-item border-0 mb-2">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed fw-medium text-dark" type="button"
                                        data-bs-toggle="collapse"
                                        data-bs-target="#collapse{{ loop.index }}"
                                        style="background-color: #f8fafc; border-radius: 8px;">
                                    {{ category }}
                                    <span class="badge bg-primary bg-opacity-10 text-primary ms-2">{{ skills|length }}</span>
                                </button>
                            </h2>
                            <div id="collapse{{ loop.index }}" class="accordion-collapse collapse"
                                 data-bs-parent="#itSkillsAccordion">
                                <div class="accordion-body p-4 pt-0">
                                    <div class="row g-3">
                                        {% for skill in skills %}
                                        <div class="col-md-6">
                                            <div class="form-check py-1">
                                                <input class="form-check-input" type="checkbox"
                                                       name="it_skills" value="{{ skill }}"
                                                       id="it_{{ skill }}"
                                                       {% for user_skill in user_skills %}
                                                           {% if user_skill[0] == skill and user_skill[1] == 'IT' %}checked{% endif %}
                                                       {% endfor %}>
                                                <label class="form-check-label ms-2 text-dark" for="it_{{ skill }}" style="font-weight: 400;">
                                                    {{ skill }}
                                                </label>
                                            </div>
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <!-- Non-IT Skills Section -->
            <div class="card shadow-sm border-0" style="background-color: #f8fafc;">
                <div class="card-header bg-transparent border-0 pt-4 px-4">
                    <h5 class="fw-semibold text-dark mb-0">
                        <i class="fas fa-users me-2 text-success"></i>Soft Skills
                    </h5>
                </div>
                <div class="card-body p-0">
                    <div class="accordion" id="nonItSkillsAccordion" style="--bs-accordion-border-color: transparent;">
                        {% for category, skills in non_it_skills.items() %}
                        <div class="accordion-item border-0 mb-2">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed fw-medium text-dark" type="button"
                                        data-bs-toggle="collapse"
                                        data-bs-target="#nonItCollapse{{ loop.index }}"
                                        style="background-color: #f8fafc; border-radius: 8px;">
                                    {{ category }}
                                    <span class="badge bg-success bg-opacity-10 text-success ms-2">{{ skills|length }}</span>
                                </button>
                            </h2>
                            <div id="nonItCollapse{{ loop.index }}" class="accordion-collapse collapse"
                                 data-bs-parent="#nonItSkillsAccordion">
                                <div class="accordion-body p-4 pt-0">
                                    <div class="row g-3">
                                        {% for skill in skills %}
                                        <div class="col-md-6">
                                            <div class="form-check py-1">
                                                <input class="form-check-input" type="checkbox"
                                                       name="non_it_skills" value="{{ skill }}"
                                                       id="non_it_{{ skill }}"
                                                       {% for user_skill in user_skills %}
                                                           {% if user_skill[0] == skill and user_skill[1] == 'Non-IT' %}checked{% endif %}
                                                       {% endfor %}>
                                                <label class="form-check-label ms-2 text-dark" for="non_it_{{ skill }}" style="font-weight: 400;">
                                                    {{ skill }}
                                                </label>
                                            </div>
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <!-- Desktop Save Button -->
            <div class="d-none d-md-flex justify-content-end mt-5">
                <button type="submit" class="btn btn-primary px-4">
                    <i class="fas fa-save me-2"></i>Save Changes
                </button>
            </div>

            <!-- Sticky Save Bar (mobile) -->
            <div class="mobile-save-bar d-md-none fixed-bottom bg-white border-top py-2">
                <div class="container d-flex justify-content-end">
                    <button type="submit" form="profileForm" class="btn btn-primary px-4">
                        <i class="fas fa-save me-2"></i>Save Changes
                    </button>
                </div>
            </div>
        </div>
    </form>
</div>

<style>
/* Card and accordion tuning */
.card { border: none; border-radius: 12px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.05), 0 1px 2px rgba(0,0,0,0.03); margin-bottom: 1.5rem; }
.accordion { --bs-accordion-bg: transparent; --bs-accordion-border-color: transparent; --bs-accordion-btn-focus-box-shadow: none; --bs-accordion-active-color: #1d4ed8; --bs-accordion-active-bg: #eff6ff; }
.accordion-button { font-weight: 500; color: #2d3748; background-color: #f8fafc; border: none; border-radius: 8px !important; transition: all 0.2s ease; }
.accordion-button:not(.collapsed) { color: #1d4ed8; background-color: #eff6ff; box-shadow: none; }
.accordion-body { padding: 0.5rem 1.25rem 1.25rem; }

/* Inputs/Buttons */
.form-check-input { width: 1.1em; height: 1.1em; border: 1px solid #cbd5e0; }
.form-check-input:checked { background-color: #2563eb; border-color: #2563eb; }
.btn-primary { background-color: #2563eb; border: none; padding: 0.55rem 1.5rem; border-radius: 8px; }
.btn-primary:hover { background-color: #1d4ed8; }



/* Mobile adjustments */
@media (max-width: 768px) {
  .accordion-button { padding: 0.75rem 1rem; font-size: 0.95rem; }
  .accordion-body { padding: 0.5rem 1rem 1rem; }
  .mobile-save-bar { z-index: 1030; padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 0.25rem); }
}
</style>

<script>
// simple button active toggle (optional)
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.accordion-button').forEach(btn => {
    btn.addEventListener('click', () => btn.classList.toggle('active'));
  });
});
</script>
{% endblock %}
